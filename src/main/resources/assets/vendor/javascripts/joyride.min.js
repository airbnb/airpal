  /*
 * jQuery Foundation Joyride Plugin 2.1
 * http://foundation.zurb.com
 * Copyright 2013, ZURB
 * Free to use under the MIT license.
 * http://www.opensource.org/licenses/mit-license.php
*/

(function(e,t,n){"use strict";var r={version:"2.1",tipLocation:"bottom",nubPosition:"auto",scroll:true,scrollSpeed:300,timer:0,autoStart:false,startTimerOnClick:true,startOffset:0,nextButton:true,tipAnimation:"fade",pauseAfter:[],tipAnimationFadeSpeed:300,cookieMonster:false,cookieName:"joyride",cookieDomain:false,cookiePath:false,localStorage:false,localStorageKey:"joyride",tipContainer:"body",modal:false,expose:false,postExposeCallback:e.noop,preRideCallback:e.noop,postRideCallback:e.noop,preStepCallback:e.noop,postStepCallback:e.noop,template:{link:'<a href="#close" class="joyride-close-tip">X</a>',timer:'<div class="joyride-timer-indicator-wrap"><span class="joyride-timer-indicator"></span></div>',tip:'<div class="joyride-tip-guide"><span class="joyride-nub"></span></div>',wrapper:'<div class="joyride-content-wrapper" role="dialog"></div>',button:'<a href="#" class="joyride-next-tip"></a>',modal:'<div class="joyride-modal-bg"></div>',expose:'<div class="joyride-expose-wrapper"></div>',exposeCover:'<div class="joyride-expose-cover"></div>'}},i=i||false,s={},o={init:function(n){return this.each(function(){if(e.isEmptyObject(s)){s=e.extend(true,r,n);s.document=t.document;s.$document=e(s.document);s.$window=e(t);s.$content_el=e(this);s.$body=e(s.tipContainer);s.body_offset=e(s.tipContainer).position();s.$tip_content=e("> li",s.$content_el);s.paused=false;s.attempts=0;s.tipLocationPatterns={top:["bottom"],bottom:[],left:["right","top","bottom"],right:["left","top","bottom"]};o.jquery_check();if(!e.isFunction(e.cookie)){s.cookieMonster=false}if((!s.cookieMonster||!e.cookie(s.cookieName))&&(!s.localStorage||!o.support_localstorage()||!localStorage.getItem(s.localStorageKey))){s.$tip_content.each(function(t){o.create({$li:e(this),index:t})});if(s.autoStart){if(!s.startTimerOnClick&&s.timer>0){o.show("init");o.startTimer()}else{o.show("init")}}}s.$document.on("click.joyride",".joyride-next-tip, .joyride-modal-bg",function(e){e.preventDefault();if(s.$li.next().length<1){o.end()}else if(s.timer>0){clearTimeout(s.automate);o.hide();o.show();o.startTimer()}else{o.hide();o.show()}});s.$document.on("click.joyride",".joyride-close-tip",function(e){e.preventDefault();o.end(true)});s.$window.bind("resize.joyride",function(t){if(s.$li){if(s.exposed&&s.exposed.length>0){var n=e(s.exposed);n.each(function(){var t=e(this);o.un_expose(t);o.expose(t)})}if(o.is_phone()){o.pos_phone()}else{o.pos_default()}}})}else{o.restart()}})},resume:function(){o.set_li();o.show()},nextTip:function(){if(s.$li.next().length<1){o.end()}else if(s.timer>0){clearTimeout(s.automate);o.hide();o.show();o.startTimer()}else{o.hide();o.show()}},tip_template:function(t){var n,r,i;t.tip_class=t.tip_class||"";n=e(s.template.tip).addClass(t.tip_class);r=e.trim(e(t.li).html())+o.button_text(t.button_text)+s.template.link+o.timer_instance(t.index);i=e(s.template.wrapper);if(t.li.attr("data-aria-labelledby")){i.attr("aria-labelledby",t.li.attr("data-aria-labelledby"))}if(t.li.attr("data-aria-describedby")){i.attr("aria-describedby",t.li.attr("data-aria-describedby"))}n.append(i);n.first().attr("data-index",t.index);e(".joyride-content-wrapper",n).append(r);return n[0]},timer_instance:function(t){var n;if(t===0&&s.startTimerOnClick&&s.timer>0||s.timer===0){n=""}else{n=o.outerHTML(e(s.template.timer)[0])}return n},button_text:function(t){if(s.nextButton){t=e.trim(t)||"Next";t=o.outerHTML(e(s.template.button).append(t)[0])}else{t=""}return t},create:function(t){var n=t.$li.attr("data-button")||t.$li.attr("data-text"),r=t.$li.attr("class"),i=e(o.tip_template({tip_class:r,index:t.index,button_text:n,li:t.$li}));e(s.tipContainer).append(i)},show:function(t){var r={},i,u=[],a=0,f,l=null;if(s.$li===n||e.inArray(s.$li.index(),s.pauseAfter)===-1){if(s.paused){s.paused=false}else{o.set_li(t)}s.attempts=0;if(s.$li.length&&s.$target.length>0){if(t){s.preRideCallback(s.$li.index(),s.$next_tip);if(s.modal){o.show_modal()}}s.preStepCallback(s.$li.index(),s.$next_tip);u=(s.$li.data("options")||":").split(";");a=u.length;for(i=a-1;i>=0;i--){f=u[i].split(":");if(f.length===2){r[e.trim(f[0])]=e.trim(f[1])}}s.tipSettings=e.extend({},s,r);s.tipSettings.tipLocationPattern=s.tipLocationPatterns[s.tipSettings.tipLocation];if(s.modal&&s.expose){o.expose()}if(!/body/i.test(s.$target.selector)&&s.scroll){o.scroll_to()}if(o.is_phone()){o.pos_phone(true)}else{o.pos_default(true)}l=e(".joyride-timer-indicator",s.$next_tip);if(/pop/i.test(s.tipAnimation)){l.outerWidth(0);if(s.timer>0){s.$next_tip.show();l.animate({width:e(".joyride-timer-indicator-wrap",s.$next_tip).outerWidth()},s.timer)}else{s.$next_tip.show()}}else if(/fade/i.test(s.tipAnimation)){l.outerWidth(0);if(s.timer>0){s.$next_tip.fadeIn(s.tipAnimationFadeSpeed);s.$next_tip.show();l.animate({width:e(".joyride-timer-indicator-wrap",s.$next_tip).outerWidth()},s.timer)}else{s.$next_tip.fadeIn(s.tipAnimationFadeSpeed)}}s.$current_tip=s.$next_tip;e(".joyride-next-tip",s.$current_tip).focus();o.tabbable(s.$current_tip)}else if(s.$li&&s.$target.length<1){o.show()}else{o.end()}}else{s.paused=true}},is_phone:function(){if(i){return i.mq("only screen and (max-width: 767px)")}return s.$window.width()<767?true:false},support_localstorage:function(){if(i){return i.localstorage}else{return!!t.localStorage}},hide:function(){if(s.modal&&s.expose){o.un_expose()}if(!s.modal){e(".joyride-modal-bg").hide()}s.$current_tip.hide();s.postStepCallback(s.$li.index(),s.$current_tip)},set_li:function(e){if(e){s.$li=s.$tip_content.eq(s.startOffset);o.set_next_tip();s.$current_tip=s.$next_tip}else{s.$li=s.$li.next();o.set_next_tip()}o.set_target()},set_next_tip:function(){s.$next_tip=e(".joyride-tip-guide[data-index="+s.$li.index()+"]")},set_target:function(){var t=s.$li.attr("data-class"),n=s.$li.attr("data-id"),r=function(){if(n){return e(s.document.getElementById(n))}else if(t){return e("."+t).filter(":visible").first()}else{return e("body")}};s.$target=r()},scroll_to:function(){var t,n;t=s.$window.height()/2;n=Math.ceil(s.$target.offset().top-t+s.$next_tip.outerHeight());e("html, body").stop().animate({scrollTop:n},s.scrollSpeed)},paused:function(){if(e.inArray(s.$li.index()+1,s.pauseAfter)===-1){return true}return false},destroy:function(){if(!e.isEmptyObject(s)){s.$document.off(".joyride")}e(t).off(".joyride");e(".joyride-close-tip, .joyride-next-tip, .joyride-modal-bg").off(".joyride");e(".joyride-tip-guide, .joyride-modal-bg").remove();clearTimeout(s.automate);s={}},restart:function(){if(!s.autoStart){if(!s.startTimerOnClick&&s.timer>0){o.show("init");o.startTimer()}else{o.show("init")}s.autoStart=true}else{o.hide();s.$li=n;o.show("init")}},pos_default:function(t){var n=Math.ceil(s.$window.height()/2),r=s.$next_tip.offset(),i=e(".joyride-nub",s.$next_tip),u=Math.ceil(i.outerWidth()/2),a=Math.ceil(i.outerHeight()/2),f=t||false;if(f){s.$next_tip.css("visibility","hidden");s.$next_tip.show()}if(!/body/i.test(s.$target.selector)){var l=s.tipSettings.tipAdjustmentY?parseInt(s.tipSettings.tipAdjustmentY):0,c=s.tipSettings.tipAdjustmentX?parseInt(s.tipSettings.tipAdjustmentX):0;if(o.bottom()){s.$next_tip.css({top:s.$target.offset().top+a+s.$target.outerHeight()+l,left:s.$target.offset().left+c});if(/right/i.test(s.tipSettings.nubPosition)){s.$next_tip.css("left",s.$target.offset().left-s.$next_tip.outerWidth()+s.$target.outerWidth())}o.nub_position(i,s.tipSettings.nubPosition,"top")}else if(o.top()){s.$next_tip.css({top:s.$target.offset().top-s.$next_tip.outerHeight()-a+l,left:s.$target.offset().left+c});o.nub_position(i,s.tipSettings.nubPosition,"bottom")}else if(o.right()){s.$next_tip.css({top:s.$target.offset().top+l,left:s.$target.outerWidth()+s.$target.offset().left+u+c});o.nub_position(i,s.tipSettings.nubPosition,"left")}else if(o.left()){s.$next_tip.css({top:s.$target.offset().top+l,left:s.$target.offset().left-s.$next_tip.outerWidth()-u+c});o.nub_position(i,s.tipSettings.nubPosition,"right")}if(!o.visible(o.corners(s.$next_tip))&&s.attempts<s.tipSettings.tipLocationPattern.length){i.removeClass("bottom").removeClass("top").removeClass("right").removeClass("left");s.tipSettings.tipLocation=s.tipSettings.tipLocationPattern[s.attempts];s.attempts++;o.pos_default(true)}}else if(s.$li.length){o.pos_modal(i)}if(f){s.$next_tip.hide();s.$next_tip.css("visibility","visible")}},pos_phone:function(t){var n=s.$next_tip.outerHeight(),r=s.$next_tip.offset(),i=s.$target.outerHeight(),u=e(".joyride-nub",s.$next_tip),a=Math.ceil(u.outerHeight()/2),f=t||false;u.removeClass("bottom").removeClass("top").removeClass("right").removeClass("left");if(f){s.$next_tip.css("visibility","hidden");s.$next_tip.show()}if(!/body/i.test(s.$target.selector)){if(o.top()){s.$next_tip.offset({top:s.$target.offset().top-n-a});u.addClass("bottom")}else{s.$next_tip.offset({top:s.$target.offset().top+i+a});u.addClass("top")}}else if(s.$li.length){o.pos_modal(u)}if(f){s.$next_tip.hide();s.$next_tip.css("visibility","visible")}},pos_modal:function(e){o.center();e.hide();o.show_modal()},show_modal:function(){if(e(".joyride-modal-bg").length<1){e("body").append(s.template.modal).show()}if(/pop/i.test(s.tipAnimation)){e(".joyride-modal-bg").show()}else{e(".joyride-modal-bg").fadeIn(s.tipAnimationFadeSpeed)}},expose:function(){var n,r,i,u,a="expose-"+Math.floor(Math.random()*1e4);if(arguments.length>0&&arguments[0]instanceof e){i=arguments[0]}else if(s.$target&&!/body/i.test(s.$target.selector)){i=s.$target}else{return false}if(i.length<1){if(t.console){console.error("element not valid",i)}return false}n=e(s.template.expose);s.$body.append(n);n.css({top:i.offset().top,left:i.offset().left,width:i.outerWidth(true),height:i.outerHeight(true)});r=e(s.template.exposeCover);u={zIndex:i.css("z-index"),position:i.css("position")};i.css("z-index",n.css("z-index")*1+1);if(u.position=="static"){i.css("position","relative")}i.data("expose-css",u);r.css({top:i.offset().top,left:i.offset().left,width:i.outerWidth(true),height:i.outerHeight(true)});s.$body.append(r);n.addClass(a);r.addClass(a);if(s.tipSettings["exposeClass"]){n.addClass(s.tipSettings["exposeClass"]);r.addClass(s.tipSettings["exposeClass"])}i.data("expose",a);s.postExposeCallback(s.$li.index(),s.$next_tip,i);o.add_exposed(i)},un_expose:function(){var n,r,i,u,a=false;if(arguments.length>0&&arguments[0]instanceof e){r=arguments[0]}else if(s.$target&&!/body/i.test(s.$target.selector)){r=s.$target}else{return false}if(r.length<1){if(t.console){console.error("element not valid",r)}return false}n=r.data("expose");i=e("."+n);if(arguments.length>1){a=arguments[1]}if(a===true){e(".joyride-expose-wrapper,.joyride-expose-cover").remove()}else{i.remove()}u=r.data("expose-css");if(u.zIndex=="auto"){r.css("z-index","")}else{r.css("z-index",u.zIndex)}if(u.position!=r.css("position")){if(u.position=="static"){r.css("position","")}else{r.css("position",u.position)}}r.removeData("expose");r.removeData("expose-z-index");o.remove_exposed(r)},add_exposed:function(t){s.exposed=s.exposed||[];if(t instanceof e){s.exposed.push(t[0])}else if(typeof t=="string"){s.exposed.push(t)}},remove_exposed:function(t){var n;if(t instanceof e){n=t[0]}else if(typeof t=="string"){n=t}s.exposed=s.exposed||[];for(var r=0;r<s.exposed.length;r++){if(s.exposed[r]==n){s.exposed.splice(r,1);return}}},center:function(){var e=s.$window;s.$next_tip.css({top:(e.height()-s.$next_tip.outerHeight())/2+e.scrollTop(),left:(e.width()-s.$next_tip.outerWidth())/2+e.scrollLeft()});return true},bottom:function(){return/bottom/i.test(s.tipSettings.tipLocation)},top:function(){return/top/i.test(s.tipSettings.tipLocation)},right:function(){return/right/i.test(s.tipSettings.tipLocation)},left:function(){return/left/i.test(s.tipSettings.tipLocation)},corners:function(e){var t=s.$window,n=t.height()/2,r=Math.ceil(s.$target.offset().top-n+s.$next_tip.outerHeight()),i=t.width()+t.scrollLeft(),o=t.height()+r,u=t.height()+t.scrollTop(),a=t.scrollTop();if(r<a){if(r<0){a=0}else{a=r}}if(o>u){u=o}return[e.offset().top<a,i<e.offset().left+e.outerWidth(),u<e.offset().top+e.outerHeight(),t.scrollLeft()>e.offset().left]},visible:function(e){var t=e.length;while(t--){if(e[t])return false}return true},nub_position:function(e,t,n){if(t==="auto"){e.addClass(n)}else{e.addClass(t)}},startTimer:function(){if(s.$li.length){s.automate=setTimeout(function(){o.hide();o.show();o.startTimer()},s.timer)}else{clearTimeout(s.automate)}},end:function(t){t=t||false;if(t){s.$window.unbind("resize.joyride")}if(s.cookieMonster){e.cookie(s.cookieName,"ridden",{expires:365,domain:s.cookieDomain,path:s.cookiePath})}if(s.localStorage){localStorage.setItem(s.localStorageKey,true)}if(s.timer>0){clearTimeout(s.automate)}if(s.modal&&s.expose){o.un_expose()}if(s.$current_tip){s.$current_tip.hide()}if(s.$li){s.postStepCallback(s.$li.index(),s.$current_tip,t);s.postRideCallback(s.$li.index(),s.$current_tip,t)}e(".joyride-modal-bg").hide()},jquery_check:function(){if(!e.isFunction(e.fn.on)){e.fn.on=function(e,t,n){return this.delegate(t,e,n)};e.fn.off=function(e,t,n){return this.undelegate(t,e,n)};return false}return true},outerHTML:function(e){return e.outerHTML||(new XMLSerializer).serializeToString(e)},version:function(){return s.version},tabbable:function(t){e(t).on("keydown",function(n){if(!n.isDefaultPrevented()&&n.keyCode&&n.keyCode===27){n.preventDefault();o.end(true);return}if(n.keyCode!==9){return}var r=e(t).find(":tabbable"),i=r.filter(":first"),s=r.filter(":last");if(n.target===s[0]&&!n.shiftKey){i.focus(1);n.preventDefault()}else if(n.target===i[0]&&n.shiftKey){s.focus(1);n.preventDefault()}})}};e.fn.joyride=function(t){if(o[t]){return o[t].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof t==="object"||!t){return o.init.apply(this,arguments)}else{e.error("Method "+t+" does not exist on jQuery.joyride")}}})(jQuery,this)